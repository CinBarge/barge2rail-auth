{% extends 'partials/base.html' %}
{% block title %}Create BOL from Template{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
  <div class="row">
    <div class="col-12">
      <h2><i class="fas fa-bolt"></i> Create BOL from Template: {{ template.supplier.name }}</h2>
      <p class="text-muted">
        <i class="fas fa-info-circle"></i> 
        Fields below are pre-filled from the template. Edit as needed and add products.
      </p>
    </div>
  </div>

  <form method="post">
    {% csrf_token %}
    
    <div class="row mt-3">
      <!-- Shipper Information -->
      <div class="col-md-6">
        <div class="card">
          <div class="card-header bg-primary text-white">
            <h5><i class="fas fa-shipping-fast"></i> Shipper Information</h5>
          </div>
          <div class="card-body">
            <div class="mb-3">
              <label for="shipper_name" class="form-label">Shipper Name</label>
              <input type="text" class="form-control" id="shipper_name" name="shipper_name" 
                     value="{{ field_mapping.shipper_name|default:'' }}">
            </div>
            <div class="mb-3">
              <label for="shipper_address" class="form-label">Shipper Address</label>
              <textarea class="form-control" id="shipper_address" name="shipper_address" rows="3">{{ field_mapping.shipper_address|default:'' }}</textarea>
            </div>
            <div class="mb-3">
              <label for="origin" class="form-label">Origin/Port of Loading</label>
              <input type="text" class="form-control" id="origin" name="origin" 
                     value="{{ field_mapping.origin|default:'' }}">
            </div>
          </div>
        </div>
      </div>

      <!-- Consignee Information -->
      <div class="col-md-6">
        <div class="card">
          <div class="card-header bg-info text-white">
            <h5><i class="fas fa-building"></i> Consignee Information</h5>
          </div>
          <div class="card-body">
            <div class="mb-3">
              <label for="consignee_name" class="form-label">Consignee Name</label>
              <input type="text" class="form-control" id="consignee_name" name="consignee_name" 
                     value="{{ field_mapping.consignee_name|default:'' }}">
            </div>
            <div class="mb-3">
              <label for="consignee_address" class="form-label">Consignee Address</label>
              <textarea class="form-control" id="consignee_address" name="consignee_address" rows="3">{{ field_mapping.consignee_address|default:'' }}</textarea>
            </div>
            <div class="mb-3">
              <label for="destination" class="form-label">Destination/Port of Discharge</label>
              <input type="text" class="form-control" id="destination" name="destination" 
                     value="{{ field_mapping.destination|default:'' }}">
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row mt-3">
      <!-- Transport Details -->
      <div class="col-md-6">
        <div class="card">
          <div class="card-header bg-success text-white">
            <h5><i class="fas fa-truck"></i> Transport Details</h5>
          </div>
          <div class="card-body">
            <div class="mb-3">
              <label for="carrier" class="form-label">Carrier</label>
              <input type="text" class="form-control" id="carrier" name="carrier" 
                     value="{{ field_mapping.carrier|default:'' }}">
            </div>
            <div class="mb-3">
              <label for="vessel_name" class="form-label">Vessel/Barge Name</label>
              <input type="text" class="form-control" id="vessel_name" name="vessel_name" 
                     value="{{ field_mapping.vessel_name|default:'' }}">
            </div>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="container_number" class="form-label">Container Number</label>
                <input type="text" class="form-control" id="container_number" name="container_number" 
                       value="{{ field_mapping.container_number|default:'' }}">
              </div>
              <div class="col-md-6 mb-3">
                <label for="seal_number" class="form-label">Seal Number</label>
                <input type="text" class="form-control" id="seal_number" name="seal_number" 
                       value="{{ field_mapping.seal_number|default:'' }}">
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Additional Information -->
      <div class="col-md-6">
        <div class="card">
          <div class="card-header bg-warning">
            <h5><i class="fas fa-info-circle"></i> Additional Information</h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="delivery_date" class="form-label">Delivery Date</label>
                <input type="date" class="form-control" id="delivery_date" name="delivery_date" 
                       value="{{ field_mapping.delivery_date|default:'' }}">
              </div>
              <div class="col-md-6 mb-3">
                <label for="freight_charges" class="form-label">Freight Charges ($)</label>
                <input type="number" step="0.01" class="form-control" id="freight_charges" name="freight_charges" 
                       value="{{ field_mapping.freight_charges|default:'' }}">
              </div>
            </div>
            <div class="mb-3">
              <label for="notes" class="form-label">Notes/Special Instructions</label>
              <textarea class="form-control" id="notes" name="notes" rows="3">{{ field_mapping.notes|default:'' }}</textarea>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="row mt-4 mb-4">
      <div class="col-12">
        <button type="submit" class="btn btn-primary btn-lg">
          <i class="fas fa-save"></i> Create Draft BOL
        </button>
        <a href="{% url 'dashboard-bol' %}" class="btn btn-secondary btn-lg">
          <i class="fas fa-times"></i> Cancel
        </a>
        <div class="mt-2">
          <small class="text-muted">
            <i class="fas fa-info-circle"></i> 
            After creating the BOL, you'll be able to add products on the next page.
          </small>
        </div>
      </div>
    </div>
  </form>

  <!-- Template Info -->
  <div class="row mt-4">
    <div class="col-12">
      <div class="card">
        <div class="card-header bg-secondary text-white">
          <h5><i class="fas fa-file-pdf"></i> Template Information</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-4">
              <p><strong>Supplier:</strong> {{ template.supplier.name }}</p>
            </div>
            <div class="col-md-4">
              <p><strong>Template File:</strong> {{ template.file_name }}</p>
            </div>
            <div class="col-md-4">
              <p><strong>Uploaded:</strong> {{ template.uploaded_at|date:"M d, Y" }}</p>
            </div>
          </div>
          {% if template.description %}
          <div class="row">
            <div class="col-12">
              <p><strong>Description:</strong> {{ template.description }}</p>
            </div>
          </div>
          {% endif %}
          <div class="row">
            <div class="col-12">
              <a href="{% url 'dashboard-bol-view-template' template.id %}" target="_blank" class="btn btn-sm btn-success">
                <i class="fas fa-eye"></i> View Template PDF
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.card-header h5 {
  margin: 0;
}
</style>
{% endblock %}
