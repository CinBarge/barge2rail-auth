{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrahead %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'sso/css/rbac-theme.css' %}">
{% endblock %}

{% block bodyclass %}{{ block.super }} rbac-page{% endblock %}

{% block content_title %}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">Home</a>
    &rsaquo; <a href="{% url 'admin:app_list' app_label='sso' %}">SSO</a>
    &rsaquo; RBAC Management
</div>
{% endblock %}

{% block content %}
<h1>RBAC Management Dashboard</h1>

<div class="stats-row">
    <div class="stat-card">
        <div class="number">{{ stats.active_roles }}</div>
        <div class="label">Active Roles</div>
    </div>
    <div class="stat-card">
        <div class="number">{{ stats.total_features }}</div>
        <div class="label">Active Features</div>
    </div>
    <div class="stat-card">
        <div class="number">{{ stats.total_assignments }}</div>
        <div class="label">User Assignments</div>
    </div>
    <div class="stat-card">
        <div class="number">{{ stats.total_permissions }}</div>
        <div class="label">Permission Mappings</div>
    </div>
</div>

<h2 class="section-title">Manage</h2>
<div class="tools-grid">
    <a href="{% url 'sso_feature_list' %}" class="tool-card">
        <h3><span class="tool-icon">&#9881;</span> Features</h3>
        <p>Create, edit, and manage application features that can have permissions assigned.</p>
    </a>
    <a href="{% url 'sso_role_list' %}" class="tool-card">
        <h3><span class="tool-icon">&#128736;</span> Roles</h3>
        <p>Create, edit, and manage roles. Click to edit permissions in the matrix view.</p>
    </a>
    <a href="{% url 'sso_assignment_list' %}" class="tool-card">
        <h3><span class="tool-icon">&#128101;</span> User Assignments</h3>
        <p>View all user-role assignments. Edit tenant codes or remove assignments.</p>
    </a>
</div>

<h2 class="section-title">Permissions</h2>
<div class="tools-grid">
    <a href="{% url 'sso_role_list' %}" class="tool-card">
        <h3><span class="tool-icon">&#9638;</span> Permission Matrix</h3>
        <p>Edit role permissions in a grid view. Select a role to open its matrix.</p>
    </a>
    <a href="{% url 'sso_effective_permissions' %}" class="tool-card">
        <h3><span class="tool-icon">&#128100;</span> Effective Permissions</h3>
        <p>See what a specific user can actually do across all their roles.</p>
    </a>
    <a href="{% url 'sso_compare_roles' %}" class="tool-card">
        <h3><span class="tool-icon">&#8646;</span> Compare Roles</h3>
        <p>Side-by-side comparison of two roles. Find differences and similarities.</p>
    </a>
</div>

<h2 class="section-title">Tools</h2>
<div class="tools-grid">
    <a href="{% url 'sso_permission_search' %}" class="tool-card">
        <h3><span class="tool-icon">&#128269;</span> Permission Search</h3>
        <p>Find which roles have specific permissions. "Who can approve BOLs?"</p>
    </a>
    <a href="{% url 'sso_bulk_assign_role' %}" class="tool-card">
        <h3><span class="tool-icon">&#128101;</span> Bulk Assign</h3>
        <p>Assign multiple users to a role at once. Great for onboarding teams.</p>
    </a>
    <a href="{% url 'sso_export_roles' %}" class="tool-card">
        <h3><span class="tool-icon">&#128229;</span> Export</h3>
        <p>Download roles and permissions as JSON for backup or migration.</p>
    </a>
    <a href="{% url 'sso_import_roles' %}" class="tool-card">
        <h3><span class="tool-icon">&#128228;</span> Import</h3>
        <p>Upload roles from JSON file to restore or sync environments.</p>
    </a>
</div>

<h2 class="section-title">Django Admin</h2>
<div class="tools-grid">
    <a href="{% url 'admin:sso_permission_changelist' %}" class="tool-card">
        <h3><span class="tool-icon">&#128274;</span> Base Permissions</h3>
        <p>View and manage base permission types (view, create, modify, etc.)</p>
    </a>
    <a href="{% url 'admin:sso_application_changelist' %}" class="tool-card">
        <h3><span class="tool-icon">&#127760;</span> Applications</h3>
        <p>Manage OAuth applications and their settings.</p>
    </a>
</div>
{% endblock %}
